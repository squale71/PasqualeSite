(function(){var n;n=function(n){return window.PasqualeSite||(window.PasqualeSite={}),PasqualeSite[n]=PasqualeSite[n]||{}};n("ViewModels");PasqualeSite.KnockoutModel=function(){function n(n,t){n.binding=!0;t&&(this.Model=t);ko.mapping.merge.fromJS(this.Model,n);ko.applyBindings(this.Model);this.Model}return n}();PasqualeSite.ViewModels.PostsViewModel=function(){function n(){this.Posts=ko.observableArray([]).withMergeConstructor(PasqualeSite.ViewModels.PostViewModel,!0);this.Tags=ko.observableArray([]).withMergeConstructor(PasqualeSite.ViewModels.TagViewModel,!0);this.Images=ko.observableArray([]).withMergeConstructor(PasqualeSite.ViewModels.PostImageViewModel,!0);this.SelectedPost=ko.observableArray([]).withMergeConstructor(PasqualeSite.ViewModels.PostViewModel,!0);this.SelectedTag=ko.observableArray([]);this.SelectedImage=ko.observableArray([]);this.NewPost=ko.observable(new PasqualeSite.ViewModels.PostViewModel);this.NewTag=ko.observable();this.PostGridOptions={data:this.Posts,columnDefs:[{field:"Id",displayName:"Id",width:90},{field:"Title",displayName:"Title",width:80},{field:"Teaser",cellClass:"Teaser",headerClass:"Teaser"},{field:"DateCreated",displayName:"Date Created"},{field:"DateModified",displayName:"Date Modified"},{field:"isFeatured",displayName:"Featured"},{field:"Priority",displayName:"Priority"}],enablePaging:!0,selectedItems:this.SelectedPost,multiSelect:!1,afterSelectionChange:function(n){return function(){return CKEDITOR.instances.content.setData(n.SelectedPost()[0].PostContent())}}(this),pagingOptions:{currentPage:ko.observable(1),pageSize:ko.observable(30),pageSizes:ko.observableArray([30,60,90]),totalServerItems:ko.observable(0)}};this.TagGridOptions={data:this.Tags,columnDefs:[{field:"Id",displayName:"Id",width:100},{field:"Name",displayName:"Name",width:200}],enablePaging:!0,selectedItems:this.SelectedTag,multiSelect:!1,disableTextSelection:!1,pagingOptions:{currentPage:ko.observable(1),pageSize:ko.observable(30),pageSizes:ko.observableArray([30,60,90]),totalServerItems:ko.observable(0)}};this.ImageGridOptions={data:this.Images,columnDefs:[{field:"Name",displayName:"Name",width:500},{field:"PathHtml",displayName:"Path",width:500},{field:"CopyButton",displayName:"Copy",width:50},{field:"Link",displayName:"Link",width:50}],enablePaging:!0,multiSelect:!1,disableTextSelection:!1,rowHeight:50,selectWithCheckboxOnly:!0,pagingOptions:{currentPage:ko.observable(1),pageSize:ko.observable(5),pageSizes:ko.observableArray([5,10,15]),totalServerItems:ko.observable(0)}};this.AddTag=function(n){return function(){return n.NewTag()&&n.NewTag().trim()!==""?$.ajax({url:approot+"Admin/AddTag",data:{name:n.NewTag()},type:"POST",success:function(t){var r,i;return r=JSON.parse(t),i=new PasqualeSite.ViewModels.TagViewModel,ko.mapping.merge.fromJS(i,r),n.Tags.push(i),PasqualeSite.notify("Success Adding New Tag","success")},error:function(){return PasqualeSite.notify("There was a problem saving the tag","error")}}):PasqualeSite.notify("You need to fill in a value in order to add a tag.","info")}}(this)}return n}();PasqualeSite.ViewModels.PostViewModel=function(){function n(){this.Id=ko.observable();this.Title=ko.observable();this.Teaser=ko.observable();this.PostContent=ko.observable("");this.DateCreated=ko.observable();this.DateModified=ko.observable();this.IsFeatured=ko.observable();this.IsActive=ko.observable();this.Priority=ko.observable();this.User=ko.observable(new PasqualeSite.ViewModels.AppUser);this.Image=ko.observable(new PasqualeSite.ViewModels.PostImageViewModel);this.FeaturePost=function(n){return function(){return n.IsFeatured(!0)}}(this);this.UnfeaturePost=function(n){return function(){return n.IsFeatured(!1)}}(this);this.EnablePost=function(n){return function(){return n.IsActive(!0)}}(this);this.DisablePost=function(n){return function(){return n.IsActive(!1)}}(this);this.SavePost=function(n){return function(t){var i;return i={Id:n.Id(),Title:n.Title(),Teaser:n.Teaser(),PostContent:n.PostContent(),DateCreated:n.DateCreated(),DateModified:n.DateModified(),IsFeatured:n.IsFeatured(),IsActive:n.IsActive(),Priority:n.Priority(),ImageId:n.Image()?n.Image().Id():null},$.ajax({url:approot+"Admin/SavePost",data:{newPost:i},type:"POST",success:function(n){var r,i;return t?(model.Model.Posts.push({}),model.Model.Posts.pop(),model.Model.SelectedPost.removeAll(),PasqualeSite.notify("Success Updating Post","success")):(r=JSON.parse(n),i=new PasqualeSite.ViewModels.PostViewModel,ko.mapping.merge.fromJS(i,r),model.Model.Posts.push(i),model.Model.NewPost(new PasqualeSite.ViewModels.PostViewModel),PasqualeSite.notify("Success Adding New Post","success"))},error:function(){return PasqualeSite.notify("There was a problem saving the post","error")}})}}(this);this.DeletePost=function(n){return function(){var t;return t=confirm("Are you sure you want to delete the post? This action cannot be undone."),t?$.ajax({url:approot+"Admin/DeletePost",data:{id:n.Id()},type:"POST",success:function(){return model.Model.Posts.remove(n),PasqualeSite.notify("Success Removing Post","success")},error:function(){return PasqualeSite.notify("There was a problem removing the post","error")}}):void 0}}(this)}return n}();PasqualeSite.ViewModels.TagViewModel=function(){function n(){this.Id=ko.observable();this.Name=ko.observable();this.SaveTag=function(n){return function(){var t;return t={Id:n.Id(),Name:n.Name()},$.ajax({url:approot+"Admin/SaveTag",data:{newTag:t},type:"POST",success:function(){return model.Model.Tags.push({}),model.Model.Tags.pop(),PasqualeSite.notify("Success Updating Tag","success")},error:function(){return PasqualeSite.notify("There was a problem saving the tag","error")}})}}(this);this.DeleteTag=function(n){return function(){return $.ajax({url:approot+"Admin/DeleteTag",data:{id:n.Id()},type:"POST",success:function(){return model.Model.Tags.remove(n),PasqualeSite.notify("Success Deleting Tag","success")},error:function(){return PasqualeSite.notify("There was a problem deleting the tag","error")}})}}(this)}return n}();PasqualeSite.ViewModels.PostImageViewModel=function(){function n(){this.Id=ko.observable();this.Name=ko.observable();this.Path=ko.observable();this.PathHtml=ko.computed(function(n){return function(){return"<input class='form-control' type='text' value='"+n.Path()+"' id='link-"+n.Name()+"' />"}}(this),this);this.Link=ko.computed(function(n){return function(){return"<a target='_blank' href='"+n.Path()+"'><span class='glyphicon glyphicon-picture'><\/span><\/a>"}}(this),this);this.CopyButton=ko.computed(function(n){return function(){return"<button class='btn btn-default' data-copytarget='#link-"+n.Name()+"'><span class='glyphicon glyphicon-copy'><\/span><\/button>"}}(this),this);this.Description=ko.observable()}return n}();PasqualeSite.ViewModels.AppUser=function(){function n(){this.Id=ko.observable();this.FirstName=ko.observable();this.LastName=ko.observable();this.UserName=ko.observable();this.Email=ko.observable();this.EmailConfirmed=ko.observable();this.Roles=ko.observableArray([])}return n}();$(function(){})}).call(this);