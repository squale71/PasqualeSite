@model PasqualeSite.Services.PostPagingModel

@{
    ViewBag.Title = "Index";
    var rand = new Random();
}

<script>
    $(document).ready(function () {
        $.ajax({
            url: "http://www.numbersapi.com/" + @Model.Total,
            type: "GET",
            dataType: "jsonp",
            success: function (data) {
                $('#postCount').append(" Here's a fun fact for you: " + data)
            }
        })
    })
</script>


<div class="container">
    <div class="row">
        <div class="col-md-9">
            @foreach (var post in Model.CurrentPosts)
            {
                <div class="row">
                    <div class="col-md-12">
                        <div class="row">
                            <div class="col-md-2">
                                <img class="img-responsive" src="@(post.Image != null ? post.Image.Path : "")" />
                            </div>
                            <div class="col-md-10">
                                <p class="bold">@post.DateCreated.ToShortDateString()</p>
                                <h2>@post.Title</h2>
                                <p class="byline"><p class="byline">by @post.Author</p>  
                            </div>                                                  
                        </div>
                        <br />
                        <div class="row">
                            <div class="col-md-12">
                                <p>@post.Teaser</p>
                                <p class="readmore"><a href="@Url.Action("Post", "Blog", new { year = post.DateCreated.Year, month = post.DateCreated.Month, day = post.DateCreated.Day, title = post.UrlTitle  })">Read More</a></p>
                                <p>
                                    @foreach (var tag in post.PostTags)
                                    {
                                        <span class="label label-default tag-data"><span class="glyphicon glyphicon-tag"></span> @tag.Tag.Name</span>
                                        <span>  </span>
                                    }
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
                <hr />
            }
        </div>
        <div class="col-md-3">
            <div class="well">
                <h4>Categories:</h4>
                @foreach (var tag in Model.Tags)
                {
                    <span class="label label-default tag-data"><span class="glyphicon glyphicon-tag"></span> @tag.Name</span>
                }
                <hr />
                <h4>Archive:</h4>
                @foreach (var time in Model.BlogMonths)
                {
                    <span class="label label-default tag-data"><span class="glyphicon glyphicon-calendar"></span> @(System.Globalization.DateTimeFormatInfo.CurrentInfo.GetAbbreviatedMonthName(time.Month) + " " + time.Year)</span>
                }
            </div>
            <div class="well">

                @if (Model.Total == 0)
                {
                    <p id="postCount">No posts returned? I hope it's because of your strict filters and not because I never actually wrong anything.</p>
                }
                else if (Model.Total == 1)
                {
                    <p id="postCount">Only one post? I hope it's a good one!</p>
                }
                else
                {
                    <p id="postCount">It looks like we got back @Model.Total posts.</p>
                }
            </div>
        </div>
    </div>
</div>
